# Weekly Thesis Analysis System

## Overview

Your AI Manhattan Project tracker now includes:
1. **Automatic Database Storage** - All market data and news saved to SQLite
2. **Weekly AI-Powered Analysis** - Claude analyzes thesis progress every Sunday
3. **US vs China Comparison** - Tracks state-led AI infrastructure buildout in both countries

## Database Schema

### Market Data Table
Stores all ticker prices, performance metrics:
- Symbol, price, daily/30d/90d/365d performance
- Volume, market cap
- Timestamp + date for querying

### Market News Table
Stores all news articles:
- Article ID (prevents duplicates)
- Symbol, headline, summary
- Source, URL, published date
- Significance flag (for important news)
- Sentiment (bullish/bearish)

### Weekly Analysis Table
Stores AI-generated thesis reports:
- Week start/end dates
- Analysis type (thesis, performance, news)
- Title, summary, detailed analysis
- Key events, recommendations
- Metadata for additional context

## Weekly Analysis Features

**Every Sunday at 6 PM ET**, the system:

1. **Pulls Week's Data from Database**
   - All ticker performance (start vs end of week)
   - All significant news articles
   - Historical trends

2. **AI Analysis via Claude** (using your Anthropic API key)
   - Analyzes US policy developments (DOE, nuclear, uranium)
   - Tracks China state-led buildout (state grid, data centers, nuclear)
   - Compares US vs China progress
   - Identifies thesis catalysts and risks
   - Provides actionable recommendations

3. **Posts Comprehensive Report** to #global-ai
   - Executive summary
   - Key events of the week
   - Portfolio performance breakdown
   - US vs China scorecard
   - Outlook for next week
   - Recommended actions

## What Gets Analyzed

### US Thesis Indicators
- DOE/White House AI infrastructure announcements
- Uranium/nuclear policy developments
- Data center construction & power demand
- Grid modernization projects
- Critical minerals/supply chain news

### China Thesis Indicators
- State Grid expansion
- Nuclear reactor approvals/construction
- Data center buildout by Alibaba/Tencent/Baidu
- Uranium imports/stockpiling
- Rare earth/copper production

### Portfolio Performance
- Best/worst performers of the week
- Category trends (nuclear up, REITs down, etc.)
- Correlation with news events
- Historical context (vs 30/90/365 day)

## Example Weekly Report Structure

```markdown
## üìä AI Manhattan Project - Weekly Thesis Analysis
**Week of Nov 11-17, 2025**

### üéØ Executive Summary
The AI Manhattan Project thesis strengthened this week with three major catalysts:
[AI-generated analysis of top 3 developments]

### üá∫üá∏ US Developments
- DOE announced $2B for grid modernization (BULLISH for PWR, MYRG)
- Oklo received NRC design approval (MAJOR catalyst)
- [More AI-identified events]

### üá®üá≥ China Developments
- China Nuclear approved 4 new reactors (BULLISH thesis)
- State Grid capex increase 15% (infrastructure acceleration)
- [More AI-identified events]

### üìà Portfolio Performance
**Best Performers:**
üü© OKLO: +18.2% (NRC approval catalyst)
üü¢ CCJ: +8.1% (uranium spot price +3%)

**Worst Performers:**
üî¥ DLR: -2.1% (REIT sector weakness)

### ‚öñÔ∏è US vs China Scorecard
| Metric | US | China | Winner |
|--------|----|----|--------|
| Nuclear Approvals | 2 | 4 | üá®üá≥ |
| Grid Investment | $2B | $8B | üá®üá≥ |
| Policy Momentum | Strong | Very Strong | üá®üá≥ |

### üîÆ Outlook & Recommendations
**Thesis Status:** ‚úÖ ON TRACK

**Next Week Catalysts:**
- Cameco earnings (Nov 20)
- China uranium import data (Nov 22)

**Action Items:**
- Consider adding to CCJ on any dip
- Monitor OKLO for NRC final approval timeline
- Watch China rare earth export restrictions

---
*Generated by AI analysis of 127 data points | Powered by Claude*
```

## Accessing the Data

### Query Historical Market Data
```typescript
// Get OKLO performance for last 30 days
db.getMarketData('OKLO', '2025-10-18', '2025-11-17');

// Get all tickers for a specific date
db.getMarketDataByDate('2025-11-17');
```

### Query News
```typescript
// Get all significant news from last week
db.getSignificantNews('2025-11-10', '2025-11-17');

// Get news for specific ticker
db.getMarketNews('OKLO', '2025-11-01', '2025-11-17');
```

### Query Weekly Analyses
```typescript
// Get latest thesis analysis
db.getLatestWeeklyAnalysis('thesis');

// Get all analyses from Q4
db.getWeeklyAnalyses('2025-10-01', '2025-12-31');
```

## Database Location

`/Volumes/LaCie/WEBDEV/agentflow/data/agentflow.db`

- SQLite database
- Can query with any SQLite client
- Automatically backs up data
- Persistent across bot restarts

## Configuration

Add to your `.env`:
```bash
# Market Updates (including weekly analysis)
MARKET_UPDATES_ENABLED=true
MARKET_UPDATES_GUILD_ID=your_discord_guild_id
MARKET_UPDATES_DAILY_CRON=0 9 * * 1-5
MARKET_UPDATES_CLOSE_CRON=5 16 * * 1-5
MARKET_UPDATES_NEWS_CRON=0 9-16 * * 1-5
MARKET_UPDATES_WEEKLY_CRON=0 18 * * 0
MARKET_UPDATES_TIMEZONE=America/New_York

# Required API Keys
ANTHROPIC_API_KEY=your_anthropic_api_key_here
FINNHUB_API_KEY=your_finnhub_api_key_here
```

## Benefits

1. **Historical Record** - Every price, every news article, saved forever
2. **Trend Analysis** - Query performance over any time period
3. **AI Insights** - Claude analyzes data you'd never manually review
4. **Accountability** - Track thesis performance objectively
5. **Decision Support** - AI recommendations based on comprehensive data

## Implementation Status

‚úÖ **COMPLETE** - The weekly analysis system is fully implemented!

### Components Implemented

1. **WeeklyThesisAnalyzer Service** (`src/services/weeklyThesisAnalyzer.ts`)
   - Claude API integration for AI-powered analysis
   - Comprehensive data aggregation from database
   - US vs China thesis comparison logic
   - Portfolio performance analysis
   - Discord embed generation

2. **Scheduler Integration** (`src/services/marketUpdateScheduler.ts`)
   - Weekly cron job (Sunday 6 PM ET)
   - Automatic data collection and analysis
   - Discord posting with formatted embeds

3. **Database Methods** (`src/services/database.ts`)
   - `getMarketDataByDateRange()` - Query all market data for date range
   - `getMarketNewsByDateRange()` - Query all news for date range
   - `saveWeeklyAnalysis()` - Store analysis results
   - `getLatestWeeklyAnalysis()` - Retrieve past analyses

### How to Use

1. **Setup** - Ensure your `.env` has the configuration above
2. **Manual Trigger** (for testing):
   ```typescript
   // In your bot code or Discord command
   marketScheduler.triggerWeeklyAnalysis();
   ```
3. **Automatic Execution** - Runs every Sunday at 6 PM ET automatically

### Next Steps

1. ‚úÖ ~~Get Finnhub API key~~ (already configured)
2. ‚úÖ ~~Get Anthropic API key~~ (already configured)
3. Wait for first weekly analysis (Sunday 6 PM ET) OR manually trigger
4. Query database to explore your historical data
5. Refine analysis prompts in `weeklyThesisAnalyzer.ts` based on insights you want

The system is now a complete **AI-powered thesis tracking platform** that automatically collects data, analyzes trends, and provides actionable intelligence!
